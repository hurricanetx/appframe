var WeixinApi=function(){"use strict";function e(e,n){n=n||{};var i=function(e){WeixinJSBridge.invoke("shareTimeline",{appid:e.appId?e.appId:"",img_url:e.imgUrl,link:e.link,desc:e.title,title:e.desc,img_width:"640",img_height:"640"},function(e){switch(e.err_msg){case"share_timeline:cancel":n.cancel&&n.cancel(e);break;case"share_timeline:confirm":case"share_timeline:ok":n.confirm&&n.confirm(e);break;case"share_timeline:fail":default:n.fail&&n.fail(e)}n.all&&n.all(e)})};WeixinJSBridge.on("menu:share:timeline",function(a){n.async&&n.ready?(window._wx_loadedCb_=n.dataLoaded||new Function,window._wx_loadedCb_.toString().indexOf("_wx_loadedCb_")>0&&(window._wx_loadedCb_=new Function),n.dataLoaded=function(e){window._wx_loadedCb_(e),i(e)},n.ready&&n.ready(a)):(n.ready&&n.ready(a),i(e))})}function n(e,n){n=n||{};var i=function(e){WeixinJSBridge.invoke("sendAppMessage",{appid:e.appId?e.appId:"",img_url:e.imgUrl,link:e.link,desc:e.desc,title:e.title,img_width:"640",img_height:"640"},function(e){switch(e.err_msg){case"send_app_msg:cancel":n.cancel&&n.cancel(e);break;case"send_app_msg:confirm":case"send_app_msg:ok":n.confirm&&n.confirm(e);break;case"send_app_msg:fail":default:n.fail&&n.fail(e)}n.all&&n.all(e)})};WeixinJSBridge.on("menu:share:appmessage",function(a){n.async&&n.ready?(window._wx_loadedCb_=n.dataLoaded||new Function,window._wx_loadedCb_.toString().indexOf("_wx_loadedCb_")>0&&(window._wx_loadedCb_=new Function),n.dataLoaded=function(e){window._wx_loadedCb_(e),i(e)},n.ready&&n.ready(a)):(n.ready&&n.ready(a),i(e))})}function i(e,n){n=n||{};var i=function(e){WeixinJSBridge.invoke("shareWeibo",{content:e.desc,url:e.link},function(e){switch(e.err_msg){case"share_weibo:cancel":n.cancel&&n.cancel(e);break;case"share_weibo:confirm":case"share_weibo:ok":n.confirm&&n.confirm(e);break;case"share_weibo:fail":default:n.fail&&n.fail(e)}n.all&&n.all(e)})};WeixinJSBridge.on("menu:share:weibo",function(a){n.async&&n.ready?(window._wx_loadedCb_=n.dataLoaded||new Function,window._wx_loadedCb_.toString().indexOf("_wx_loadedCb_")>0&&(window._wx_loadedCb_=new Function),n.dataLoaded=function(e){window._wx_loadedCb_(e),i(e)},n.ready&&n.ready(a)):(n.ready&&n.ready(a),i(e))})}function a(e,n){n=n||{};var i=function(e,i){if("timeline"==e.shareTo){var a=i.title;i.title=i.desc||a,i.desc=a}e.generalShare({appid:i.appId?i.appId:"",img_url:i.imgUrl,link:i.link,desc:i.desc,title:i.title,img_width:"640",img_height:"640"},function(i){switch(i.err_msg){case"general_share:cancel":n.cancel&&n.cancel(i,e.shareTo);break;case"general_share:confirm":case"general_share:ok":n.confirm&&n.confirm(i,e.shareTo);break;case"general_share:fail":default:n.fail&&n.fail(i,e.shareTo)}n.all&&n.all(i,e.shareTo)})};WeixinJSBridge.on("menu:general:share",function(a){n.async&&n.ready?(window._wx_loadedCb_=n.dataLoaded||new Function,window._wx_loadedCb_.toString().indexOf("_wx_loadedCb_")>0&&(window._wx_loadedCb_=new Function),n.dataLoaded=function(e){window._wx_loadedCb_(e),i(a,e)},n.ready&&n.ready(a,a.shareTo)):(n.ready&&n.ready(a,a.shareTo),i(a,e))})}function o(e,n){n=n||{},WeixinJSBridge.invoke("addContact",{webtype:"1",username:e},function(e){var i=!e.err_msg||"add_contact:ok"==e.err_msg||"add_contact:added"==e.err_msg;i?n.success&&n.success(e):n.fail&&n.fail(e)})}function d(e,n){e&&n&&0!=n.length&&WeixinJSBridge.invoke("imagePreview",{current:e,urls:n})}function r(){WeixinJSBridge.call("showOptionMenu")}function c(){WeixinJSBridge.call("hideOptionMenu")}function t(){WeixinJSBridge.call("showToolbar")}function s(){WeixinJSBridge.call("hideToolbar")}function l(e){e&&"function"==typeof e&&WeixinJSBridge.invoke("getNetworkType",{},function(n){e(n.err_msg)})}function _(e){e=e||{},WeixinJSBridge.invoke("closeWindow",{},function(n){switch(n.err_msg){case"close_window:ok":e.success&&e.success(n);break;default:e.fail&&e.fail(n)}})}function u(e){if(e&&"function"==typeof e){var n=this,i=function(){e(n)};"undefined"==typeof window.WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",i,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",i),document.attachEvent("onWeixinJSBridgeReady",i)):i()}}function f(){return/MicroMessenger/i.test(navigator.userAgent)}function w(e){e=e||{},WeixinJSBridge.invoke("scanQRCode",{},function(n){switch(n.err_msg){case"scan_qrcode:ok":e.success&&e.success(n);break;default:e.fail&&e.fail(n)}})}function g(e,n){n=n||{},WeixinJSBridge.invoke("getInstallState",{packageUrl:e.packageUrl||"",packageName:e.packageName||""},function(e){var i=e.err_msg,a=i.match(/state:yes_?(.*)$/);a?(e.version=a[1]||"",n.success&&n.success(e)):n.fail&&n.fail(e),n.all&&n.all(e)})}function m(e){window.onerror=function(n,i,a,o){if("function"==typeof e)e({message:n,script:i,line:a,column:o});else{var d=[];d.push("额，代码有错。。。"),d.push("\n错误信息：",n),d.push("\n出错文件：",i),d.push("\n出错位置：",a+"行，"+o+"列"),alert(d.join(""))}}}return{version:"2.5",enableDebugMode:m,ready:u,shareToTimeline:e,shareToWeibo:i,shareToFriend:n,generalShare:a,addContact:o,showOptionMenu:r,hideOptionMenu:c,showToolbar:t,hideToolbar:s,getNetworkType:l,imagePreview:d,closeWindow:_,openInWeixin:f,getInstallState:g,scanQRCode:w}}();