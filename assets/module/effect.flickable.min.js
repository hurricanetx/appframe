!function(t){function e(t){var e,a;e="undefined"!=typeof t.touches[0].pageX?t.touches[0].pageX:t.pageX,a="undefined"!=typeof t.touches[0].pageY?t.touches[0].pageY:t.pageY,f=p,f.start={x:e,y:a,time:t.timeStamp},f.delta.prevPos={x:e,y:a},n(t),m&&d()}function n(t){var e,n;e="undefined"!=typeof t.touches[0].pageX?t.touches[0].pageX:t.pageX,n="undefined"!=typeof t.touches[0].pageY?t.touches[0].pageY:t.pageY;var a,i,o=e,r=n,l=e-f.start.x,s=n-f.start.y;a=e>f.delta.prevPos.x?1:e<f.delta.prevPos.x?-1:0,i=n>f.delta.prevPos.y?1:n<f.delta.prevPos.y?-1:0,f.delta.prevPos={x:o,y:r},f.delta.dist={x:l,y:s},f.delta.dir={x:a,y:i},m&&d()}function a(e){var n=t(this),a=n.data("preventDefaultAxis"),i="both"===a||"x"===a,o="both"===a||"y"===a,r=i&&Math.abs(f.delta.dist.y)>=k,l=o&&Math.abs(f.delta.dist.x)>=k;(r||l)&&e.preventDefault()}function i(t){var e=t.timeStamp-f.start.time,n=Math.abs(Math.round(f.delta.dist.x/e*100)/100),a=Math.abs(Math.round(f.delta.dist.y/e*100)/100),i=f.delta.dir.x,o=f.delta.dir.y,r=0,l=0;n>h?r=Math.abs(f.delta.dist.x)>=k?i:0:a>h&&(l=Math.abs(f.delta.dist.y)>=k?o:0),f.end.duration=e,f.end.speed={x:n,y:a},f.end.flick={x:r,y:l},m&&(c("Touch end"),d())}function o(t,e){return"x"!==e&&"y"!==e&&(e=t.height()>t.width()?"y":"x"),e}function r(t,e){if(!parseInt(e)){var e,n=t.data("segments"),a=o(t,t.data("flickDirection"));e="y"==a?t.height()/n:t.width()/n}return e}function l(){var t=document.createElement("div"),e="Khtml Ms O Moz Webkit".split(" "),n=e.length;return function(a){if(a in t.style)return!0;for(a=a.replace(/^[a-z]/,function(t){return t.toUpperCase()});n--;)if(e[n]+a in t.style)return!0;return!1}}function s(){if(!t("#flickableDebugger").length){m=!0,f=p,f.eventLog=[];var e='<div id="flickableDebugger" style="position: fixed; bottom: 0; margin: 0 auto; padding: 10px; width: 100%; background: #000; color: #fff; font-family: courier, sans-serif;">Debugger</div>';t("body").append(e)}}function c(t){m&&(console.log(t),f.eventLog.splice(0,0,t),d())}function d(){for(var e="",n=0;3>n;n++)e+=f.eventLog[n]+" | ";var a="<pre> 		last 3 events: "+e+"<br /> 		start: {x:"+f.start.x+", y:"+f.start.y+",time: "+f.start.time+"}<br /> 			delta: {<br /> 			prevPos: {"+f.delta.prevPos.x+", "+f.delta.prevPos.y+"}<br /> 			dist: {"+f.delta.dist.x+", "+f.delta.dist.y+"}<br /> 			dir: {"+f.delta.dir.x+", "+f.delta.dir.y+"}<br /> 			}<br /> 		end: {<br /> 			speed: {"+f.end.speed.x+", "+f.end.speed.y+"}<br /> 			flick: {"+f.end.flick.x+", "+f.end.flick.y+"}<br /> 			duration: "+f.end.duration+"<br /> 		} 		</pre>";t("#flickableDebugger").html(a)}var f,p={start:{x:0,y:0,time:0},delta:{prevPos:{x:0,y:0},dist:{x:0,y:0},dir:{x:0,y:0}},end:{duration:0,speed:{x:0,y:0},flick:{x:0,y:0}}},g=!1,u=0,h=.7,k=5,m=!1,y={init:function(c){var d=t.extend({enableDebugger:!1,segments:5,snapSpeed:.3,flickSnapSpeed:.3,flickThreshold:!1,segmentPx:"auto",flickDirection:"auto",preventDefault:!0,preventDefaultAxis:"both",onCreate:!1,onFlick:!1,onFlickLeft:!1,onFlickRight:!1,onFlickUp:!1,onFlickDown:!1,onScroll:!1,onScrollNext:!1,onScrollPrev:!1,onMove:!1,onStart:!1,onEnd:!1},c);return this.each(function(){var c=t(this),f=c.data("isAlive");if(!f){var p=d.segments,u=o(c,d.flickDirection);c.data("isAlive",!0).data("pos",0).data("snapSpeed",parseFloat(d.snapSpeed)).data("flickSnapSpeed",parseFloat(d.flickSnapSpeed)).data("segment",0).data("segments",p).data("flickDirection",u).data("segmentPx",r(c,d.segmentPx)).data("preventDefaultAxis",d.preventDefaultAxis),t(c).bind({onStart:function(){t(this).flickable("start",d.onStart)},onMove:function(){t(this).flickable("move",d.onMove)},onEnd:function(){t(this).flickable("finished",d.onEnd)},onScroll:function(){t(this).flickable("scrollToSegment",d.onScroll)},onScrollPrev:function(){t(this).flickable("prevSegment",d.onScrollPrev)},onScrollNext:function(){t(this).flickable("nextSegment",d.onScrollNext)},onFlick:function(){t(this).flickable("flick",d.onFlick)},onFlickLeft:function(){t(this).flickable("flickLeft",d.onFlickLeft)},onFlickRight:function(){t(this).flickable("flickRight",d.onFlickRight)},onFlickUp:function(){t(this).flickable("flickUp",d.onFlickUp)},onFlickDown:function(){t(this).flickable("flickDown",d.onFlickDown)},touchstart:function(n){e(n),t(this).trigger("onStart")},touchmove:function(e){n(e),d.preventDefault&&a.call(this,e),t(this).trigger("onMove")},touchend:function(e){i(e),t(this).trigger("onEnd")}}),l("transform")||(g=!0),parseInt(d.flickThreshold)&&(h=parseInt(d.flickThreshold)),(m||d.enableDebugger)&&s(),c.flickable("create",d.onCreate)}})},create:function(e){var n=t(this);f=p,u++,c("It's alive!"),n.attr("id")||n.attr("id","flickable"+u),n.flickable("scrollToSegment"),"function"==typeof e&&e.call(this,u)},start:function(e){c("Touch start");var n=t(this),a=parseInt(n.data("segment")),i=parseInt(n.data("segmentPx")),o=-(i*a);n.data("anchor",o),"function"==typeof e&&e.call(this,f)},segment:function(e){var n=t(this),a=parseInt(n.data("segments")),i=parseInt(n.data("segment"));return"undefined"!=typeof e&&(e>=a?e=a-1:0>e&&(e=0),e!==i?n.data("segment",e).trigger("onScroll"):n.flickable("scrollToSegment")),parseInt(n.data("segment"))},move:function(e){var n,a,i=t(this),o=i.data("flickDirection"),r=parseInt(i.data("anchor")),n=r+f.delta.dist[o];g?"y"==o?i.css("top",n):i.css("left",n):(a="y"==o?"(0,"+n+"px,0)":"("+n+"px,0,0)","undefined"!=typeof document.getElementById(i.attr("id")).style.webkitTransform?document.getElementById(i.attr("id")).style.webkitTransform="translate3d"+a:"undefined"!=typeof document.getElementById(i.attr("id")).style.mozTransform?document.getElementById(i.attr("id")).style.mozTransform="translate3d"+a:document.getElementById(i.attr("id")).style.transform="translate3d"+a),t(this).data("pos",n),"function"==typeof e&&e.call(this,f)},scrollNext:function(){t(this).trigger("onScrollNext")},scrollPrev:function(){t(this).trigger("onScrollPrev")},nextSegment:function(e){c("Next segment");var n=t(this),a=parseInt(n.data("segment"))+1;n.flickable("segment",a),"function"==typeof e&&e.call(this,f,a)},prevSegment:function(e){c("Previous segment");var n=t(this),a=parseInt(n.data("segment"))-1;n.flickable("segment",a),"function"==typeof e&&e.call(this,f,a)},flick:function(e){c("You flicked");var n=t(this);switch(f.end.flick.x){case-1:n.trigger("onFlickLeft");break;case 1:n.trigger("onFlickRight")}switch(f.end.flick.y){case-1:n.trigger("onFlickUp");break;case 1:n.trigger("onFlickDown")}"function"==typeof e&&e.call(this,f)},flickLeft:function(e){c("Flicked left");var n=t(this),a=parseInt(n.data("segment"));n.trigger("onScrollNext"),"function"==typeof e&&e.call(this,f,a)},flickRight:function(e){c("Flicked right");var n=t(this),a=parseInt(n.data("segment"));n.trigger("onScrollPrev"),"function"==typeof e&&e.call(this,f,a)},flickUp:function(e){c("Flicked up");var n=t(this),a=parseInt(n.data("segment"));n.trigger("onScrollNext"),"function"==typeof e&&e.call(this,f,a)},flickDown:function(e){c("Flicked down");var n=t(this),a=parseInt(n.data("segment"));n.trigger("onScrollPrev"),"function"==typeof e&&e.call(this,f,a)},scrollToSegment:function(e){var n,a=t(this),i=a.data("flickDirection"),o=parseFloat(a.data("snapSpeed")),r=parseFloat(a.data("flickSnapSpeed")),l=(parseInt(a.data("segments")),parseInt(a.data("segment"))),s=parseInt(a.data("segmentPx")),d=-(s*l),p="ease-out";c("Sliding to segment "+l),(f.end.flick.x||f.end.flick.y)&&(o=r,p="cubic-bezier(0, .70, .35, 1)"),a.data("anchor",d).data("pos",d).data("segment",l),g?"y"==i?a.anim({top:d},o,p):a.anim({left:d},o,p):(n="y"==i?"0px, "+d+"px, 0px":d+"px, 0px, 0px",a.anim({translate3d:n},o,p)),"function"==typeof e&&e.call(this,f,l)},finished:function(e){var n,a=t(this),i=a.data("flickDirection"),o=(parseInt(a.data("segments")),parseInt(a.data("segment"))),r=parseInt(a.data("segmentPx")),l=(parseInt(a.data("anchor")),parseInt(a.data("pos")));return n=0>l?Math.abs(Math.round(l/r)):0,c("Nearest segment is "+n),"function"==typeof e&&e.call(this,f,o),o==n&&f.end.flick[i]?a.trigger("onFlick"):(n==o+1?a.trigger("onScrollNext"):n==o-1?a.trigger("onScrollPrev"):a.flickable("segment",n),void 0)}};t.fn.flickable=function(e){return y[e]?y[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(t.error("Method "+e+" does not exist"),void 0):y.init.apply(this,arguments)}}(Zepto);