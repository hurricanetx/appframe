!function(t){"use strict";t.fn.scrape=function(e,n){function o(t,e){var n=document.createElement(t);for(var o in e)n.setAttribute(o,e[o]);return n}function i(t,e,n){for(var o=t.getImageData(0,0,e,n),i=o.data,a=[],c=0,l=i.length;l>c;c+=4){var r=i[c+3];128>r&&a.push(c)}return(a.length/(i.length/4)*100).toFixed(2)}function a(t,e,n){t.width=e,t.height=n,t.getContext("2d").clearRect(0,0,e,n)}function c(t,o){e.maskCtx.beginPath();var a=e.maskCtx.createRadialGradient(t,o,0,t,o,30);a.addColorStop(0,"rgba(0,0,0,0.6)"),a.addColorStop(1,"rgba(255, 255, 255, 0)"),e.maskCtx.fillStyle=a,e.maskCtx.arc(t,o,30,0,2*Math.PI,!0),e.maskCtx.fill(),n&&n.call(null,i(e.maskCtx,e.width,e.height))}function l(){var t=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase()),n=t?"touchstart":"mousedown",o=t?"touchmove":"mousemove";if(t)u.on("touchmove",function(t){i&&t.preventDefault()},!1),u.on("touchend",function(){i=!1},!1);else{var i=!1;u.on("mouseup",function(){i=!1},!1)}e.mask.addEventListener(n,function(n){i=!0;var o=document.documentElement;e.clientRect||(e.clientRect={left:0,top:0});var a=(t?n.touches[0].clientX:n.clientX)-e.clientRect.left+o.scrollLeft-o.clientLeft,l=(t?n.touches[0].clientY:n.clientY)-e.clientRect.top+o.scrollTop-o.clientTop;c(a,l)},!1),e.mask.addEventListener(o,function(n){if(!t&&!i)return!1;var o=document.documentElement;e.clientRect||(e.clientRect={left:0,top:0});var a=(t?n.touches[0].clientX:n.clientX)-e.clientRect.left+o.scrollLeft-o.clientLeft,l=(t?n.touches[0].clientY:n.clientY)-e.clientRect.top+o.scrollTop-o.clientTop;c(a,l)},!1)}function r(){if(e.background=e.background||o("canvas",{style:"position:absolute;left:0;top:0;"}),e.backCtx=null,e.mask=e.mask||o("canvas",{style:"position:absolute;left:0;top:0;"}),e.maskCtx=null,e.clientRect=null,u.html().replace(/[\w\W]| /g,"")||(u.append(e.background),u.append(e.mask),e.clientRect=u.node?u.node.getBoundingClientRect():null,l()),e.backCtx=e.backCtx||e.background.getContext("2d"),e.maskCtx=e.maskCtx||e.mask.getContext("2d"),"image"==e.type){var t=new Image;t.onload=function(){a(e.background,e.width,e.height),e.backCtx.drawImage(this,0,0),s()},t.src=e.lottery}else if("text"==e.type){a(e.background,e.width,e.height),e.backCtx.save(),e.backCtx.fillStyle="#FFF",e.backCtx.fillRect(0,0,e.width,e.height),e.backCtx.restore(),e.backCtx.save();var n=30;e.backCtx.font="Bold "+n+"px Arial",e.backCtx.textAlign="center",e.backCtx.fillStyle="#F60",e.backCtx.fillText(e.lottery,e.width/2,e.height/2+n/2),e.backCtx.restore(),s()}}function s(){if(a(e.mask,e.width,e.height),"color"==e.coverType)e.maskCtx.fillStyle=e.cover,e.maskCtx.fillRect(0,0,e.width,e.height),e.maskCtx.globalCompositeOperation="destination-out";else if("image"==e.coverType){var t=new Image,n=this;t.onload=function(){n.maskCtx.drawImage(this,0,0),n.maskCtx.globalCompositeOperation="destination-out"},t.src=e.cover}}var u=this;return u.node=document.getElementById(this.selector.replace("#","")),e=t.extend({},{cover:"#ccc",coverType:"color",width:this.width()||300,height:this.height()||100,lottery:null,background:null,mask:null,type:"image"},e),this.update=function(t,n){e.lottery=t,e.type=n,r()},r(),this}}(window.Zepto);