if("undefined"==typeof Zepto)throw new Error("Parallax.js's script requires Zepto");!function(a){"use strict";function r(){x.loading?a(".wrapper").append('<div class="parallax-loading"><i class="ui-loading ui-loading-white"></i></div>'):y=!1,m=0,h="stay",u=v.length,g=a(window).width(),b=a(window).height(),C=a("[data-animation]");for(var r=0;u>r;r++)a(v[r]).attr("data-id",r+1);k.addClass(x.direction).addClass(x.swipeAnim),v.css({width:g+"px",height:b+"px"}),"horizontal"===x.direction?k.css("width",g*v.length):k.css("height",b*v.length),"cover"===x.swipeAnim&&(k.css({width:g,height:b}),v[0].style.display="block"),x.loading||(a(v[m]).addClass("current"),x.onchange(m,v[m],h),l())}function t(a){return y===!0?(event.preventDefault(),!1):(z=!0,c="horizontal"===x.direction?a.pageX:a.pageY,"default"===x.swipeAnim&&(k.addClass("drag"),p=k.css("-webkit-transform").replace("matrix(","").replace(")","").split(","),p="horizontal"===x.direction?parseInt(p[4]):parseInt(p[5])),"cover"===x.swipeAnim&&x.drag&&v.addClass("drag"),f=1,void 0)}function i(a){return y===!0||z===!1?(event.preventDefault(),!1):(event.preventDefault(),w="horizontal"===x.direction?a.pageX:a.pageY,s(),x.drag&&!d()&&e(),f=2,void 0)}function n(r){y===!0||2!==f||(z=!1,w="horizontal"===x.direction?r.pageX:r.pageY,"default"!==x.swipeAnim||d()?"cover"!==x.swipeAnim||d()||(Math.abs(w-c)<=50&&w>=c&&x.drag?(o(m,"keep-backward"),h="stay"):Math.abs(w-c)<=50&&c>w&&x.drag?(o(m,"keep-forward"),h="stay"):Math.abs(w-c)>50&&w>=c&&x.drag?(o(m-1,"backward"),h="backward"):Math.abs(w-c)>50&&c>w&&x.drag?(o(m+1,"forward"),h="forward"):Math.abs(w-c)>50&&w>=c&&!x.drag?(o(m-1,"backward"),h="backward"):Math.abs(w-c)>50&&c>w&&!x.drag&&(o(m+1,"forward"),h="forward")):(k.removeClass("drag"),Math.abs(w-c)<=50?(o(m),h="stay"):w>=c?(o(m-1),h="backward"):c>w&&(o(m+1),h="forward")),x.indicator&&a(a(".parallax-h-indicator ul li, .parallax-v-indicator ul li").removeClass("current").get(m)).addClass("current"),f=3)}function e(){if("default"===x.swipeAnim){var r=p+w-c;"horizontal"===x.direction?k.css("-webkit-transform","matrix(1, 0, 0, 1, "+r+", 0)"):k.css("-webkit-transform","matrix(1, 0, 0, 1, 0, "+r+")")}else if("cover"===x.swipeAnim){var r=w-c,t=a(v[m-1]),i=a(v[m+1]);a(v).css({"z-index":0}),"horizontal"===x.direction&&w>=c?t.css({"z-index":2,display:"block","-webkit-transform":"translateX("+(r-g)+"px)"}):"horizontal"===x.direction&&c>w?i.css({"z-index":2,display:"block","-webkit-transform":"translateX("+(g+r)+"px)"}):"vertical"===x.direction&&w>=c?t.css({"z-index":2,display:"block","-webkit-transform":"translateY("+(r-b)+"px)"}):"vertical"===x.direction&&c>w&&i.css({"z-index":2,display:"block","-webkit-transform":"translateY("+(b+r)+"px)"})}}function o(r,t){if(m=r,"default"===x.swipeAnim){var i=0;i="horizontal"===x.direction?r*-g:r*-b,"horizontal"===x.direction?k.css({"-webkit-transform":"matrix(1, 0, 0, 1, "+i+", 0)"}):k.css({"-webkit-transform":"matrix(1, 0, 0, 1, 0, "+i+")"})}else"cover"===x.swipeAnim&&("keep-backward"===t&&x.drag?(v.removeClass("drag"),"horizontal"===x.direction?a(v[m-1]).css({"-webkit-transform":"translateX(-100%)"}):a(v[m-1]).css({"-webkit-transform":"translateY(-100%)"})):"keep-forward"===t&&x.drag?(v.removeClass("drag"),"horizontal"===x.direction?a(v[m+1]).css({"-webkit-transform":"translateX(100%)"}):a(v[m+1]).css({"-webkit-transform":"translateY(100%)"})):"forward"===t&&x.drag?(v.removeClass("drag"),a(v[m-1]).addClass("back"),v[m].style.webkitTransform="translate(0, 0)"):"backward"===t&&x.drag?(v.removeClass("drag"),a(v[m+1]).addClass("back"),v[m].style.webkitTransform="translate(0, 0)"):"forward"!==t||x.drag?"backward"!==t||x.drag||(k.addClass("animate"),a(v[m+1]).addClass("back"),a(v[m]).addClass("front").show()):(k.addClass("animate"),a(v[m-1]).addClass("back"),a(v[m]).addClass("front").show()));y=!0,setTimeout(function(){y=!1},300)}function s(){"horizontal"===x.direction?w>=c?k.removeClass("forward").addClass("backward"):c>w&&k.removeClass("backward").addClass("forward"):w>=c?k.removeClass("forward").addClass("backward"):c>w&&k.removeClass("backward").addClass("forward")}function d(){if("horizontal"===x.direction){if(w>=c&&0===m||c>=w&&m===u-1)return!0}else if(w>=c&&0===m||c>=w&&m===u-1)return!0;return!1}function l(){C.css({"-webkit-animation":"none"}),a(".current [data-animation]").each(function(r,t){var i=a(t),n=i.attr("data-animation"),e=i.attr("data-duration")||500,o=i.attr("data-timing-function")||"ease",s=i.attr("data-delay")?i.attr("data-delay"):0;"followSlide"===n&&("horizontal"===x.direction&&"forward"===h?n="followSlideToLeft":"horizontal"===x.direction&&"backward"===h?n="followSlideToRight":"vertical"===x.direction&&"forward"===h?n="followSlideToTop":"vertical"===x.direction&&"backward"===h&&(n="followSlideToBottom")),i.css({"-webkit-animation":n+" "+e+"ms "+o+" "+s+"ms both",animation:n+" "+e+"ms "+o+" "+s+"ms both"})})}var c,w,f,p,h,m,u,g,b,k,v,C,x,z=!1,y=!0;a.fn.parallax=function(t){return x=a.extend({},a.fn.parallax.defaults,t),this.each(function(){k=a(this),v=k.find(".page"),r()})},a.fn.parallax.defaults={direction:"vertical",swipeAnim:"default",drag:!0,loading:!1,indicator:!1,arrow:!1,onchange:function(){},orientationchange:function(){}},a(document).on("touchstart",".page",function(a){t(a.changedTouches[0])}).on("touchmove",".page",function(a){i(a.changedTouches[0])}).on("touchend",".page",function(a){n(a.changedTouches[0])}).on("webkitAnimationEnd webkitTransitionEnd",".pages",function(){"stay"!==h&&(setTimeout(function(){a(".back").hide().removeClass("back"),a(".front").show().removeClass("front"),k.removeClass("forward backward animate")},10),a(v.removeClass("current").get(m)).addClass("current"),x.onchange(m,v[m],h),l())}),a(".page *").on("webkitAnimationEnd",function(){event.stopPropagation()}),a(window).on("load",function(){if(x.loading&&(a(".parallax-loading").remove(),y=!1,a(v[m]).addClass("current"),x.onchange(m,v[m],h),l()),x.indicator){y=!1;var r="horizontal"===x.direction?"parallax-h-indicator":"parallax-v-indicator";a(".wrapper").append("<div class="+r+"></div>");for(var t="<ul>",i=1;u>=i;i++)t+=1===i?'<li class="current">'+i+"</li>":"<li>"+i+"</li>";t+="</ul>",a("."+r).append(t)}x.arrow&&(v.append('<span class="parallax-arrow"></span>'),a(v[u-1]).find(".parallax-arrow").remove())}),window.addEventListener("onorientationchange"in window?"orientationchange":"resize",function(){(180===window.orientation||0===window.orientation)&&x.orientationchange("portrait"),(90===window.orientation||-90===window.orientation)&&x.orientationchange("landscape")},!1)}(Zepto);