!function(t){function i(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6)}function s(){return[20*Math.random()-10,20*Math.random()-10]}function e(t){var i=t.css("position");return"relative"===i||"fixed"===i||"absolute"===i?!0:!1}function n(t){t.preventDefault()}function o(i){var s=this;return t.isArray(s)&&t(this).length||(s=t("body")),s.each(function(){var e=t(this),n=e.data("fz.cover");n||e.data("fz.cover",n=new h(this,t.extend({},r,"object"==typeof i&&i,e.data()))),"string"==typeof i&&n[i].call(s)})}var r={trigger:null,dismiss:null,duration:1e3,startPos:"source",offset:[0,0],expandAxis:"y",isFloat:!0,zIndex:999,callback:function(){}},h=function(i,s){this.element=t(i),this.trigger=t(s.trigger),this.dismiss=t(s.dismiss),this.option=s,this.initMask(),this.render(),this._isShown=!1,this._isDismiss=!1,this._bindTrigger(),this.position||(this.position={},this.position.screenWidth=document.documentElement.clientWidth,this.position.screenHeight=document.documentElement.clientHeight)};h.prototype={initMask:function(){this._mask=t("<div></div>"),this._mask.css({position:"absolute",top:0,left:0,width:100,height:100,"z-index":-1,"-webkit-transform":"scale(0)"})},render:function(){this._mask.appendTo(this.element),e(this.element)||this.element.css({position:"relative",overflow:"hidden"})},setConfig:function(i){return this._isShown||(i=t.extend(i,this.currentTrigger.data()),this.currentOption=i),this},show:function(t){var e=this,n=this.currentOption;if(!this._isShown&&(this.currentTrigger||t)){t&&(this.currentTrigger=t),n.callback("show",e),this._preventDefault(),e._isDismiss=!1,this._isShown=!0;var o=s(),r=2;n.isFloat&&(this._floatTrigger(),this.currentTrigger.css({zIndex:n.zIndex+1}));var h=this._getMaskPos(n.startPos,n.expandAxis),c="x"==n.expandAxis?"scale(0,1)":"y"==n.expandAxis?"scale(1,0)":"scale(0,0)";this._mask.css({left:h[0]+n.offset[0],top:h[1]+n.offset[1],background:n.background?n.background:i(),"z-index":n.zIndex,"-webkit-transform":c+" skew("+o[0]+"deg,"+o[1]+"deg)"}),this._aniMask(n.duration,n.offset,r)}return this},hide:function(){var t=this;t.option.callback("hide",t),this._isShown&&(this._isDismiss=!0,this._mask.css({"-webkit-transform":this._originTransform}))},hidden:function(){this._isShown=!1,this._isDismiss=!1,this._mask.css({"-webkit-transition":"none"}),this._relaseDefault(),this.currentTrigger.css(this._triggerOriginCss)},_bindTrigger:function(){var i=this;this.trigger.on("tap",function(){return i._isShown||(i.currentTrigger=t(this)),i.setConfig(t.extend({},t(this).data(),i.option)).show(t(this)),!1}),this.dismiss.on("tap",function(){return i.dismiss=t(this),i.hide(),!1}),this._mask[0].addEventListener("webkitTransitionEnd",function(){i._isShown&&!i._isDismiss?i.option.callback("shown",i):(i.hidden(),i.option.callback("hidden",i))},!1)},_preventDefault:function(){document.addEventListener("mousewheel",n,!1),document.body.addEventListener("touchmove",n,!1),document.documentElement.addEventListener("touchmove",n,!1)},_relaseDefault:function(){document.removeEventListener("mousewheel",n,!1),document.body.removeEventListener("touchmove",n,!1),document.documentElement.removeEventListener("touchmove",n,!1)},_floatTrigger:function(){this._triggerOriginCss={position:this.currentTrigger.css("position"),"z-index":this.currentTrigger.css("z-index")},e(this.currentTrigger)||this.currentTrigger.css({position:"relative"})},_getMaskPos:function(t,i){this.position||(this.position={},this.position.screenWidth=document.documentElement.clientWidth,this.position.screenHeight=document.documentElement.clientHeight),"x"==i?this._mask.css({height:this.position.screenHeight}):"y"==i&&this._mask.css({width:this.position.screenWidth}),this.position.scrollTop=document.body.scrollTop,this.position.scrollLeft=document.body.scrollLeft,this.position.offsetTop=this.element.offset().top,this.position.offsetLeft=this.element.offset().left,this.position.triggerLeft=this.currentTrigger.offset().left,this.position.triggerTop=this.currentTrigger.offset().top,this.position.triggerHeight=this.currentTrigger.height(),this.position.triggerWidth=this.currentTrigger.width();var s=parseInt(this._mask.css("width")),e=parseInt(this._mask.css("height")),n=this.position.scrollLeft-this.position.offsetLeft+this.position.screenWidth/2-s/2,o=0;return"top"==t?o=this.position.scrollTop-this.position.offsetTop-e/2:"bottom"==t?o=this.position.scrollTop-this.position.offsetTop+this.position.screenHeight-e/2:"center"==t?o=this.position.scrollTop-this.position.offsetTop+this.position.screenHeight/2-e/2:(n=this.position.triggerLeft-this.position.offsetLeft+this.position.triggerWidth/2-s/2,o=this.position.triggerTop-this.position.offsetTop+this.position.triggerHeight/2-e/2),[n,o]},_aniMask:function(t,i,s){var e=this;this._originTransform=this._mask.css("-webkit-transform");var n=Math.ceil(this.position.screenWidth/parseInt(this._mask.css("width")))*s,o=Math.ceil(this.position.screenHeight/parseInt(this._mask.css("height")))*s;setTimeout(function(){e._mask.css({"-webkit-transition":"all "+t+"ms","-webkit-transform":"scale("+n+","+o+") skew(0deg,0deg)"})},200)}},t.fn.cover=t.cover=o}(window.Zepto);